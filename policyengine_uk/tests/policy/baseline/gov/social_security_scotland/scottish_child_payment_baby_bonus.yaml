# Tests for Scottish Child Payment Premium for under-ones reform
#
# POLICY: Children under 1 receive FIXED £40/week TOTAL payment
#         Children 1+ receive standard SCP rate (£27.15 in 2026, inflates thereafter)
#
# This is NOT a fixed bonus - it's a fixed total amount.
# As standard rate inflates, the effective "premium" decreases to maintain £40 total.
#
# 2026 calculations:
# - Standard SCP: £27.15/week * 52 = £1,411.80/year
# - Premium for under-1s: £40/week * 52 = £2,080/year (TOTAL, not base + bonus)
# - Effective premium: £40 - £27.15 = £12.85/week (but this changes as base inflates)

# Test 1: Scottish family with 1 baby (age 0) - WITHOUT reform
- name: Scottish family with 1 baby - baseline (no baby bonus)
  period: 2026
  absolute_error_margin: 1
  input:
    people:
      parent:
        age: 30
      baby:
        age: 0
    benunits:
      family:
        members:
          - parent
          - baby
        universal_credit: 5000
    households:
      household:
        members:
          - parent
          - baby
        region: SCOTLAND
  output:
    # 1 child * £27.15/week * 52 weeks = £1,411.80
    scottish_child_payment: 1412

# Test 2: Scottish family with 1 baby (age 0) - WITH reform
- name: Scottish family with 1 baby - with baby bonus
  period: 2026
  absolute_error_margin: 1
  reforms: policyengine_uk.reforms.scotland.scottish_child_payment_reform.scottish_child_payment_reform
  input:
    gov.contrib.scotland.scottish_child_payment.in_effect: true
    people:
      parent:
        age: 30
      baby:
        age: 0
    benunits:
      family:
        members:
          - parent
          - baby
        universal_credit: 5000
    households:
      household:
        members:
          - parent
          - baby
        region: SCOTLAND
  output:
    # 1 baby * £40/week * 52 = £2,080/year (TOTAL payment for under-1)
    scottish_child_payment: 2080

# Test 3: Scottish family with 2 babies (both age 0) - WITH reform
- name: Scottish family with 2 babies - with baby bonus
  period: 2026
  absolute_error_margin: 1
  reforms: policyengine_uk.reforms.scotland.scottish_child_payment_reform.scottish_child_payment_reform
  input:
    gov.contrib.scotland.scottish_child_payment.in_effect: true
    people:
      parent:
        age: 30
      baby1:
        age: 0
      baby2:
        age: 0
    benunits:
      family:
        members:
          - parent
          - baby1
          - baby2
        universal_credit: 5000
    households:
      household:
        members:
          - parent
          - baby1
          - baby2
        region: SCOTLAND
  output:
    # 2 babies * £40/week * 52 = £4,160/year (TOTAL payment for 2 under-1s)
    scottish_child_payment: 4160

# Test 4: Scottish family with 1 baby and 1 older child - WITH reform
- name: Scottish family with 1 baby and 1 older child - with baby bonus
  period: 2026
  absolute_error_margin: 1
  reforms: policyengine_uk.reforms.scotland.scottish_child_payment_reform.scottish_child_payment_reform
  input:
    gov.contrib.scotland.scottish_child_payment.in_effect: true
    people:
      parent:
        age: 30
      baby:
        age: 0
      older_child:
        age: 5
    benunits:
      family:
        members:
          - parent
          - baby
          - older_child
        universal_credit: 5000
    households:
      household:
        members:
          - parent
          - baby
          - older_child
        region: SCOTLAND
  output:
    # 1 baby @ £40/week + 1 older child @ £27.15/week = £67.15/week
    # £67.15 * 52 = £3,491.80/year
    scottish_child_payment: 3492

# Test 5: Scottish family with only older children (no babies) - WITH reform
- name: Scottish family with older children only - no baby bonus
  period: 2026
  absolute_error_margin: 1
  reforms: policyengine_uk.reforms.scotland.scottish_child_payment_reform.scottish_child_payment_reform
  input:
    gov.contrib.scotland.scottish_child_payment.in_effect: true
    people:
      parent:
        age: 30
      child1:
        age: 3
      child2:
        age: 7
    benunits:
      family:
        members:
          - parent
          - child1
          - child2
        universal_credit: 5000
    households:
      household:
        members:
          - parent
          - child1
          - child2
        region: SCOTLAND
  output:
    # 2 older children @ £27.15/week * 52 = £2,823.60 (standard rate, no premium)
    scottish_child_payment: 2824

# Test 6: English family with baby - no SCP regardless of reform
- name: English family with baby - no SCP
  period: 2026
  absolute_error_margin: 1
  reforms: policyengine_uk.reforms.scotland.scottish_child_payment_reform.scottish_child_payment_reform
  input:
    gov.contrib.scotland.scottish_child_payment.in_effect: true
    people:
      parent:
        age: 30
      baby:
        age: 0
    benunits:
      family:
        members:
          - parent
          - baby
        universal_credit: 5000
    households:
      household:
        members:
          - parent
          - baby
        region: NORTH_EAST
  output:
    scottish_child_payment: 0

# Test 7: Child at age boundary (exactly 1 year old) - no baby bonus
- name: Scottish family with 1 year old child - no baby bonus
  period: 2026
  absolute_error_margin: 1
  reforms: policyengine_uk.reforms.scotland.scottish_child_payment_reform.scottish_child_payment_reform
  input:
    gov.contrib.scotland.scottish_child_payment.in_effect: true
    people:
      parent:
        age: 30
      child:
        age: 1
    benunits:
      family:
        members:
          - parent
          - child
        universal_credit: 5000
    households:
      household:
        members:
          - parent
          - child
        region: SCOTLAND
  output:
    # 1 child @ £27.15/week * 52 = £1,411.80 (standard rate - age >= 1, no premium)
    scottish_child_payment: 1412

# Test 8: Higher income (£45k) - no qualifying benefit, no SCP
- name: Scottish family with £45k income - no SCP (no qualifying benefit)
  period: 2026
  absolute_error_margin: 1
  reforms: policyengine_uk.reforms.scotland.scottish_child_payment_reform.scottish_child_payment_reform
  input:
    gov.contrib.scotland.scottish_child_payment.in_effect: true
    people:
      parent:
        age: 30
        employment_income: 45000
      baby:
        age: 0
    benunits:
      family:
        members:
          - parent
          - baby
    households:
      household:
        members:
          - parent
          - baby
        region: SCOTLAND
  output:
    # No UC at £45k income, so no SCP eligibility
    scottish_child_payment: 0

# Test 9: Higher income (£50k) - no qualifying benefit, no SCP
- name: Scottish family with £50k income - no SCP (no qualifying benefit)
  period: 2026
  absolute_error_margin: 1
  reforms: policyengine_uk.reforms.scotland.scottish_child_payment_reform.scottish_child_payment_reform
  input:
    gov.contrib.scotland.scottish_child_payment.in_effect: true
    people:
      parent:
        age: 30
        employment_income: 50000
      baby:
        age: 0
    benunits:
      family:
        members:
          - parent
          - baby
    households:
      household:
        members:
          - parent
          - baby
        region: SCOTLAND
  output:
    # No UC at £50k income, so no SCP eligibility
    scottish_child_payment: 0
