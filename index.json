{"version":2,"kind":"Notebook","sha256":"ec6d40e0530e8cffdaee436ad6a002b129b56714ba657a2ccc6da39374a6da8c","slug":"index","location":"/index.ipynb","dependencies":[],"frontmatter":{"title":"PolicyEngine-UK","content_includes_title":false,"kernelspec":{"name":"python3","display_name":".venv","language":"python"},"authors":[{"nameParsed":{"literal":"PolicyEngine","family":"PolicyEngine"},"name":"PolicyEngine","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/policyengine/policyengine-uk","copyright":"2024","edit_url":"https://github.com/policyengine/policyengine-uk/blob/master/docs/book/index.ipynb","exports":[{"format":"ipynb","filename":"index.ipynb","url":"/build/index-465722892dd2f0285da92bc29b879caf.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This book contains an introduction to using PolicyEngine-UK to model UK taxes and benefits. It is currently a work in progress and may be added to. PolicyEngine-UK is a microsimulation model of the UK tax and benefit system: it is a model which calculates variable values over UK entities from given policy parameters and structures. In practice, this gives it two main uses: calculating statistics under current tax and benefit law, and simulating effects of potential new changes to the legislation.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zg3TlMl2rg"}],"key":"vEi7LETAjb"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We’re grateful to the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fwQNzCIhrY"},{"type":"link","url":"https://www.iser.essex.ac.uk/research/projects/ukmod","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"UKMOD","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wZhTt47ke2"}],"urlSource":"https://www.iser.essex.ac.uk/research/projects/ukmod","key":"nEH0dZ7kDm"},{"type":"text","value":" team for publishing descriptions of their model; our ability to reference these descriptions accelerated OpenFisca UK’s development. UKMOD is maintained, developed and managed by the Centre for Microsimulation and Policy Analysis at the Institute for Social and Economic Research (ISER), University of Essex.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uoeIBMB4MA"}],"key":"NWF4aHSfTl"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Code examples and outputs are re-run automatically on each new version of PolicyEngine-UK.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"I4bLwm2kUf"}],"key":"InDTnvCQgu"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Short demo","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"uRYHYgrxJF"}],"identifier":"short-demo","label":"Short demo","html_id":"short-demo","implicit":true,"key":"MYxcbVqB52"},{"type":"heading","depth":3,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Baseline estimation","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"pKCADPLRZK"}],"identifier":"baseline-estimation","label":"Baseline estimation","html_id":"baseline-estimation","implicit":true,"key":"dijzhCeLGf"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Calculating, for example, the total Income Tax liability by region can be done with the following code:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Rh0oKcal9h"}],"key":"RBrI5REG86"}],"key":"m9UlFuZW2N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from policyengine_uk import Microsimulation\nimport pandas as pd\n\nENHANCED_FRS = \"hf://policyengine/policyengine-uk-data/enhanced_frs_2022_23.h5\"\n\nsim = Microsimulation(dataset=ENHANCED_FRS)\n\ndf = sim.calculate_dataframe(\n    [\n        \"household_id\",  # If the first variable is household level, the dataframe will project everything to households. Same for people.\n        \"income_tax\",\n        \"region\",\n    ],\n    period=2025,\n)\n\ndf.groupby(\"region\").income_tax.sum().sort_values(\n    ascending=False\n) / 1e9  # Weights automatically applied","key":"biDNE1VeRu"},{"type":"output","id":"xOWEDEN7dfBWqykvgNmcQ","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"region\nLONDON              78.710210\nSOUTH_EAST          75.588976\nEAST_OF_ENGLAND     30.134433\nWEST_MIDLANDS       23.276691\nSCOTLAND            23.037309\nNORTH_WEST          20.306150\nSOUTH_WEST          17.589321\nYORKSHIRE           15.903155\nEAST_MIDLANDS       14.536368\nWALES               10.113785\nNORTH_EAST           7.983999\nNORTHERN_IRELAND     5.428561\ndtype: float64","content_type":"text/plain"}}}],"key":"wm16cth9sG"}],"key":"TqtgsBKwji"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reform evaluation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j0HaJO80ge"}],"identifier":"reform-evaluation","label":"Reform evaluation","html_id":"reform-evaluation","implicit":true,"key":"tK3Cimd6V8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Below is an example of simulating the effects of a reform (namely, increasing the basic rate of income tax from 20% to 23%).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FyarevAWUF"}],"key":"lpfwN3Xgl7"}],"key":"BhXrZlrAdU"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from policyengine_uk.model_api import *\n\n\ndef change_tax_parameters(parameters):\n    parameters.gov.hmrc.income_tax.rates.uk.brackets[0].rate.update(\n        period=periods.period(\"year:2019:10\"), value=0.23\n    )\n    return parameters\n\n\nclass reform(Reform):\n    def apply(self):\n        self.modify_parameters(change_tax_parameters)\n\n\nbaseline = Microsimulation(dataset=ENHANCED_FRS)\nreformed = Microsimulation(dataset=ENHANCED_FRS, reform=reform)\nrevenue = (\n    reformed.calculate(\"gov_balance\", 2025).sum()\n    - baseline.calc(\"gov_balance\", 2025).sum()\n)\nf\"Revenue: £{round(revenue / 1e9, 1)}bn\"","visibility":"hide","key":"uC0AMdbwx6"},{"type":"output","id":"Wp5_v_Y_pd4o7dbf7-_fJ","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"'Revenue: £21.3bn'","content_type":"text/plain"}}}],"visibility":"show","key":"O5eYj3Rtfy"}],"visibility":"show","key":"KpKjtjxKGe"}],"key":"xq8W1ne6ZN"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"next":{"title":"Getting started","url":"/getting-started","group":"Usage"}}},"domain":"http://localhost:3000"}