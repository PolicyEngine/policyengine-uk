<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Creating policy scenarios - PolicyEngine UK documentation</title><meta property="og:title" content="Creating policy scenarios - PolicyEngine UK documentation"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><link rel="stylesheet" href="/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/favicon.ico"/><link rel="stylesheet" href="/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/build/logo-2bd7d2ab9c2d9ac8ba7bbafb653bd229.png" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="PolicyEngine UK documentation" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/">PolicyEngine UK documentation</a><div data-state="open" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Usage" class="block break-words rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200 cursor-pointer">Usage</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:Rmp8p:" class="pl-3 pr-[2px] collapsible-content"><a title="Getting started" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/getting-started">Getting started</a><a title="Running simulations" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/simulations">Running simulations</a><a title="Creating policy scenarios" aria-current="page" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg bg-blue-300/30 active" href="/scenarios">Creating policy scenarios</a></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Assumptions" class="block break-words rounded py-2 grow cursor-pointer">Assumptions</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Validation" class="block break-words rounded py-2 grow cursor-pointer">Validation</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Policy" class="block break-words rounded py-2 grow cursor-pointer">Policy</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/policyengine/policyengine-uk" title="GitHub Repository: policyengine/policyengine-uk" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><a href="https://github.com/policyengine/policyengine-uk/blob/master/docs/book/usage/scenarios.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Creating policy scenarios</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78top:" data-state="closed">PolicyEngine</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><p>The <code>Scenario</code> class lets you define policy reforms and apply them to simulations. This guide shows you how to create everything from simple parameter changes to complex reform packages, and how to combine different policy ideas together.</p><h2 id="your-first-policy-scenario" class="relative group"><span class="heading-text">Your first policy scenario</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#your-first-policy-scenario" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Let’s start by creating a scenario that reduces the basic rate of income tax from 20% to 15%:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from policyengine_uk import Scenario, Simulation

# Create a scenario with one policy change
scenario = Scenario(parameter_changes={
    &quot;gov.hmrc.income_tax.rates.uk[0].rate&quot;: 0.15
})

# Apply it to a simulation
situation = {
    &quot;people&quot;: {
        &quot;person&quot;: {
            &quot;age&quot;: {2025: 35},
            &quot;employment_income&quot;: {2025: 40_000}
        }
    },
    &quot;benunits&quot;: {&quot;benunit&quot;: {&quot;members&quot;: [&quot;person&quot;]}},
    &quot;households&quot;: {&quot;household&quot;: {&quot;members&quot;: [&quot;person&quot;]}}
}

sim = Simulation(situation=situation, scenario=scenario)
income_tax = sim.calculate(&quot;income_tax&quot;, 2025).mean()
print(f&quot;Income tax under 15% basic rate: £{income_tax:.2f}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>Under this scenario, this person would pay £2,486 instead of the current £4,486 - a reduction of £2,000 per year due to the lower tax rate.</p><h2 id="understanding-parameter-paths" class="relative group"><span class="heading-text">Understanding parameter paths</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#understanding-parameter-paths" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>PolicyEngine UK organises policy parameters in a hierarchical structure. Each parameter has a path that describes where it sits in the system:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Income tax parameters
&quot;gov.hmrc.income_tax.rates.uk[0].rate&quot;          # Basic rate (20%)
&quot;gov.hmrc.income_tax.rates.uk[1].rate&quot;          # Higher rate (40%)
&quot;gov.hmrc.income_tax.personal_allowance&quot;        # Personal allowance
&quot;gov.hmrc.income_tax.rates.uk[0].threshold&quot;     # Basic rate threshold

# Universal Credit parameters
&quot;gov.dwp.universal_credit.standard_allowance.single.OVER_25&quot;     # Single person allowance
&quot;gov.dwp.universal_credit.elements.housing.max_monthly_cap&quot;      # Housing cost cap
&quot;gov.dwp.universal_credit.means_test.income_disregard&quot;           # Work allowance

# Child benefits
&quot;gov.hmrc.child_benefit.rates.first_child&quot;      # First child rate
&quot;gov.hmrc.child_benefit.rates.additional_child&quot; # Additional children rate</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>You can find parameter paths by exploring the PolicyEngine web app or looking in the <code>parameters/</code> directory of the codebase.</p><h2 id="creating-comprehensive-reform-packages" class="relative group"><span class="heading-text">Creating comprehensive reform packages</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#creating-comprehensive-reform-packages" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Real policy proposals often involve multiple changes. Here’s how to create a comprehensive reform:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># A comprehensive package that increases Universal Credit support while adjusting income tax
# This represents the kind of coordinated policy change you might see in a budget
welfare_reform = Scenario(parameter_changes={
    # Increase UC standard allowances
    &quot;gov.dwp.universal_credit.standard_allowance.single.OVER_25&quot;: 500,
    &quot;gov.dwp.universal_credit.standard_allowance.single.UNDER_25&quot;: 400,
    &quot;gov.dwp.universal_credit.standard_allowance.couple&quot;: 700,
    
    # Reduce UC taper rate (less benefit withdrawn per pound earned)
    &quot;gov.dwp.universal_credit.means_test.reduction_rate&quot;: 0.55,
    
    # Increase income tax personal allowance
    &quot;gov.hmrc.income_tax.personal_allowance&quot;: 15_000,
    
    # Reduce basic rate slightly to help fund UC increases
    &quot;gov.hmrc.income_tax.rates.uk[0].rate&quot;: 0.22
})

# Test on a working family
family_situation = {
    &quot;people&quot;: {
        &quot;parent&quot;: {&quot;age&quot;: {2025: 30}, &quot;employment_income&quot;: {2025: 20_000}},
        &quot;child&quot;: {&quot;age&quot;: {2025: 5}}
    },
    &quot;benunits&quot;: {&quot;family&quot;: {&quot;members&quot;: [&quot;parent&quot;, &quot;child&quot;]}},
    &quot;households&quot;: {
        &quot;home&quot;: {
            &quot;members&quot;: [&quot;parent&quot;, &quot;child&quot;],
            &quot;housing_costs&quot;: {2025: 7200}  # Annual housing costs
        }
    }
}

reformed_sim = Simulation(situation=family_situation, scenario=welfare_reform)

# Calculate the impact of this comprehensive package on the family
uc_amount = reformed_sim.calculate(&quot;universal_credit&quot;, 2025).mean()
income_tax = reformed_sim.calculate(&quot;income_tax&quot;, 2025).mean()
net_income = reformed_sim.calculate(&quot;household_net_income&quot;, 2025).mean()

print(f&quot;Universal Credit: £{uc_amount:.2f} per month&quot;)
print(f&quot;Income tax: £{income_tax:.2f} per year&quot;)
print(f&quot;Monthly net income: £{net_income/12:.2f}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h2 id="combining-scenarios" class="relative group"><span class="heading-text">Combining scenarios</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#combining-scenarios" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>You can combine different scenarios using the <code>+</code> operator, which is useful for testing different combinations of policies:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create separate scenarios for different policy areas
tax_scenario = Scenario(parameter_changes={
    &quot;gov.hmrc.income_tax.personal_allowance&quot;: 15_000,
    &quot;gov.hmrc.income_tax.rates.uk[0].rate&quot;: 0.18
})

benefits_scenario = Scenario(parameter_changes={
    &quot;gov.dwp.universal_credit.standard_allowance.single.OVER_25&quot;: 450,
    &quot;gov.dwp.universal_credit.means_test.reduction_rate&quot;: 0.50
})

childcare_scenario = Scenario(parameter_changes={
    &quot;gov.dwp.universal_credit.elements.childcare.max_proportion&quot;: 0.90
})

# Combine them in different ways
tax_and_benefits = tax_scenario + benefits_scenario
full_package = tax_scenario + benefits_scenario + childcare_scenario

# Test each combination to see how different policy areas interact
# This shows how you can build up complex policies piece by piece
for name, scenario in [(&quot;Tax only&quot;, tax_scenario), (&quot;Benefits only&quot;, benefits_scenario), 
                      (&quot;Tax + benefits&quot;, tax_and_benefits), (&quot;Full package&quot;, full_package)]:
    sim = Simulation(situation=family_situation, scenario=scenario)
    net_income = sim.calculate(&quot;household_net_income&quot;, 2025).mean()
    print(f&quot;{name}: £{net_income/12:.2f} per month&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h2 id="defining-structural-scenarios" class="relative group"><span class="heading-text">Defining structural scenarios</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-structural-scenarios" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Beyond simple parameter changes, you sometimes need scenarios that make structural modifications to how the tax-benefit system works. Let’s walk through how to create these, using examples similar to those in PolicyEngine UK’s scenarios module.</p><h3 id="creating-a-two-child-limit-repeal-scenario" class="relative group"><span class="heading-text">Creating a two-child limit repeal scenario</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#creating-a-two-child-limit-repeal-scenario" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The two-child limit restricts Universal Credit child elements to the first two children. Here’s how to build a scenario that removes this restriction:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import numpy as np
from policyengine_uk import Scenario

# The two-child limit is controlled by this parameter
# Setting it to infinity effectively removes the limit
repeal_two_child_limit = Scenario(parameter_changes={
    &quot;gov.dwp.universal_credit.elements.child.limit.child_count&quot;: {
        &quot;year:2026:10&quot;: np.inf  # From October 2026 onwards, no limit
    }
})

# Test this on a family with three children
large_family = {
    &quot;people&quot;: {
        &quot;parent&quot;: {&quot;age&quot;: {2026: 35}, &quot;employment_income&quot;: {2026: 18_000}},
        &quot;child1&quot;: {&quot;age&quot;: {2026: 12}},
        &quot;child2&quot;: {&quot;age&quot;: {2026: 8}},
        &quot;child3&quot;: {&quot;age&quot;: {2026: 4}}  # Third child - currently gets no UC support
    },
    &quot;benunits&quot;: {&quot;family&quot;: {&quot;members&quot;: [&quot;parent&quot;, &quot;child1&quot;, &quot;child2&quot;, &quot;child3&quot;]}},
    &quot;households&quot;: {
        &quot;home&quot;: {
            &quot;members&quot;: [&quot;parent&quot;, &quot;child1&quot;, &quot;child2&quot;, &quot;child3&quot;],
            &quot;housing_costs&quot;: {2026: 10200}  # Annual housing costs
        }
    }
}

# Compare the impact
baseline_sim = Simulation(situation=large_family)
reformed_sim = Simulation(situation=large_family, scenario=repeal_two_child_limit)

baseline_uc = baseline_sim.calculate(&quot;universal_credit&quot;, 2026).mean()
reformed_uc = reformed_sim.calculate(&quot;universal_credit&quot;, 2026).mean()

increase = reformed_uc - baseline_uc
print(f&quot;UC increase from third child: £{increase:.2f} per month&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h3 id="building-a-benefit-cap-reindexing-scenario" class="relative group"><span class="heading-text">Building a benefit cap reindexing scenario</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#building-a-benefit-cap-reindexing-scenario" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The benefit cap hasn’t risen with inflation since 2016. Here’s how to create a scenario that automatically indexes it to CPI:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from policyengine_uk import Scenario, Simulation
from policyengine_core.parameters import Parameter

def reindex_benefit_cap_to_cpi(simulation: Simulation):
    &quot;&quot;&quot;Modify simulation to index benefit cap parameters to CPI inflation&quot;&quot;&quot;
    # Reset the parameter system to make changes
    simulation.tax_benefit_system.reset_parameters()
    
    # Find all benefit cap parameters in the system
    params = simulation.tax_benefit_system.parameters.gov.dwp.benefit_cap.get_descendants()
    
    # Filter to only the actual parameter values (leaf nodes)
    cap_parameters = [param for param in params if isinstance(param, Parameter)]
    
    for parameter in cap_parameters:
        # Remove any values after 2025 (current frozen values)
        parameter.values_list = [
            entry for entry in parameter.values_list 
            if entry.instant_str &lt; &quot;2026-01-01&quot;
        ]
        
        # Set the parameter to follow CPI uprating from 2026
        parameter.metadata.update(uprating=&quot;gov.benefit_uprating_cpi&quot;)
    
    # Reprocess the parameters to apply changes
    simulation.tax_benefit_system.process_parameters()

# Create the scenario using a simulation modifier
reindex_benefit_cap = Scenario(simulation_modifier=reindex_benefit_cap_to_cpi)

# Test on a family that might hit the benefit cap
benefit_cap_family = {
    &quot;people&quot;: {
        &quot;parent1&quot;: {&quot;age&quot;: {2026: 30}, &quot;employment_income&quot;: {2026: 0}},
        &quot;parent2&quot;: {&quot;age&quot;: {2026: 28}, &quot;employment_income&quot;: {2026: 0}},
        &quot;child1&quot;: {&quot;age&quot;: {2026: 6}},
        &quot;child2&quot;: {&quot;age&quot;: {2026: 3}}
    },
    &quot;benunits&quot;: {&quot;family&quot;: {&quot;members&quot;: [&quot;parent1&quot;, &quot;parent2&quot;, &quot;child1&quot;, &quot;child2&quot;]}},
    &quot;households&quot;: {
        &quot;home&quot;: {
            &quot;members&quot;: [&quot;parent1&quot;, &quot;parent2&quot;, &quot;child1&quot;, &quot;child2&quot;],
            &quot;housing_costs&quot;: {2026: 14400}  # High annual housing costs
        }
    }
}

baseline_sim = Simulation(situation=benefit_cap_family)
reformed_sim = Simulation(situation=benefit_cap_family, scenario=reindex_benefit_cap)

# Compare the benefit cap levels
baseline_cap = baseline_sim.calculate(&quot;benefit_cap&quot;, 2026).mean()
reformed_cap = reformed_sim.calculate(&quot;benefit_cap&quot;, 2026).mean()

print(f&quot;Benefit cap - frozen: £{baseline_cap:.0f}/year, indexed: £{reformed_cap:.0f}/year&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h2 id="advanced-scenario-techniques" class="relative group"><span class="heading-text">Advanced scenario techniques</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#advanced-scenario-techniques" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="time-varying-parameters" class="relative group"><span class="heading-text">Time-varying parameters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#time-varying-parameters" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Some reforms phase in over time:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># A scenario that gradually increases the personal allowance over four years
# This kind of phasing helps manage fiscal costs and economic adjustment
phased_scenario = Scenario(parameter_changes={
    &quot;gov.hmrc.income_tax.personal_allowance&quot;: {
        &quot;2025&quot;: 13_000,
        &quot;2026&quot;: 14_000,
        &quot;2027&quot;: 15_000,
        &quot;2028&quot;: 16_000
    }
})

# Test this on a middle-income earner to see the progressive impact
situation = {
    &quot;people&quot;: {&quot;person&quot;: {&quot;age&quot;: {2025: 30}, &quot;employment_income&quot;: {2025: 35_000}}},
    &quot;benunits&quot;: {&quot;benunit&quot;: {&quot;members&quot;: [&quot;person&quot;]}},
    &quot;households&quot;: {&quot;household&quot;: {&quot;members&quot;: [&quot;person&quot;]}}
}

sim = Simulation(situation=situation, scenario=phased_scenario)

# Show how the tax burden decreases year by year
for year in [2025, 2026, 2027, 2028]:
    allowance = sim.calculate(&quot;income_tax_personal_allowance&quot;, year).mean()
    tax = sim.calculate(&quot;income_tax&quot;, year).mean()
    print(f&quot;{year}: Personal allowance £{allowance:.0f}, annual tax £{tax:.2f}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h3 id="creating-complex-scenarios-with-simulation-modifiers" class="relative group"><span class="heading-text">Creating complex scenarios with simulation modifiers</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#creating-complex-scenarios-with-simulation-modifiers" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Some policy changes require modifying individual records rather than just changing parameters. Here’s how to build a scenario that phases out PIP payments for some claimants over time:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import numpy as np
from policyengine_uk import Scenario, Simulation

def phase_out_pip_gradually(sim: Simulation):
    &quot;&quot;&quot;Gradually phase out PIP for a proportion of claimants between 2025-2029&quot;&quot;&quot;
    # Set random seed for reproducible results
    np.random.seed(42)
    
    # Create random assignment for each person
    pip_phase_out_seed = np.random.random(len(sim.calculate(&quot;person_id&quot;)))
    
    # Define the phase-out period
    start_year = 2025
    end_year = 2029
    
    # Apply phase-out year by year
    for year in range(start_year, end_year + 1):
        # Get current PIP payments
        current_pip = sim.calculate(&quot;pip&quot;, year)
        
        # Calculate how far through the phase-out we are
        phase_progress = (year - start_year) / (end_year - start_year)
        
        # 25% of claimants lose PIP, gradually over the period
        # In year 1, nobody loses it; by final year, 25% have lost it completely
        affected_threshold = 0.25 * phase_progress
        
        # Set PIP to zero for affected claimants
        current_pip[pip_phase_out_seed &lt; affected_threshold] = 0
        
        # Apply the modified values back to the simulation
        sim.set_input(&quot;pip&quot;, year, current_pip)
    
    return sim

# Create the scenario
pip_phase_out = Scenario(simulation_modifier=phase_out_pip_gradually)

# Test on someone who receives PIP
pip_recipient = {
    &quot;people&quot;: {
        &quot;person&quot;: {
            &quot;age&quot;: {2025: 45},
            &quot;pip&quot;: {2025: 150},  # Weekly PIP payment
            &quot;employment_income&quot;: {2025: 8_000}
        }
    },
    &quot;benunits&quot;: {&quot;benunit&quot;: {&quot;members&quot;: [&quot;person&quot;]}},
    &quot;households&quot;: {&quot;household&quot;: {&quot;members&quot;: [&quot;person&quot;]}}
}

# Compare baseline and phase-out scenarios
baseline_sim = Simulation(situation=pip_recipient)
reformed_sim = Simulation(situation=pip_recipient, scenario=pip_phase_out)

# Show how PIP changes over the phase-out period
for year in [2025, 2027, 2029]:
    baseline_pip = baseline_sim.calculate(&quot;pip&quot;, year).mean()
    reformed_pip = reformed_sim.calculate(&quot;pip&quot;, year).mean()
    print(f&quot;{year}: Baseline £{baseline_pip:.0f}/week, with phase-out £{reformed_pip:.0f}/week&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h3 id="building-universal-credit-scenarios-with-dynamic-changes" class="relative group"><span class="heading-text">Building Universal Credit scenarios with dynamic changes</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#building-universal-credit-scenarios-with-dynamic-changes" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Some scenarios need to make changes that depend on the simulation’s own data. Here’s how to create a UC scenario that adjusts payments based on claimant characteristics:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from policyengine_uk import Scenario, Microsimulation
import numpy as np

def modify_uc_for_new_claimants(sim: Microsimulation):
    &quot;&quot;&quot;Reduce health elements for new UC claimants while increasing standard allowances&quot;&quot;&quot;
    # Access the parameter system to check if reforms are active
    rebalancing_params = sim.tax_benefit_system.parameters.gov.dwp.universal_credit.rebalancing
    
    # Create random assignment to simulate new vs existing claimants
    np.random.seed(42)
    uc_seed = np.random.random(len(sim.calculate(&quot;benunit_id&quot;)))
    
    # Proportion of claimants who are &quot;new&quot; each year (based on real data)
    new_claimant_rates = {
        2025: 0.00,  # No change in 2025
        2026: 0.11,  # 11% are new claimants
        2027: 0.13,
        2028: 0.16,
        2029: 0.22
    }
    
    # Apply changes year by year
    for year in range(2026, 2030):
        if not rebalancing_params.active(year):
            continue  # Skip if reforms aren&#x27;t active this year
            
        # Identify new claimants
        is_new_claimant = uc_seed &lt; new_claimant_rates[year]
        
        # Modify health element for new claimants
        current_health_element = sim.calculate(&quot;uc_LCWRA_element&quot;, year)
        new_health_amount = rebalancing_params.new_claimant_health_element(year) * 12
        
        # Set new amount for new claimants who get health element
        current_health_element[
            (current_health_element &gt; 0) &amp; is_new_claimant
        ] = new_health_amount
        
        sim.set_input(&quot;uc_LCWRA_element&quot;, year, current_health_element)
        
        # Increase standard allowances for everyone
        uplift_rate = rebalancing_params.standard_allowance_uplift(year)
        previous_allowance = sim.calculate(&quot;uc_standard_allowance&quot;, year - 1)
        new_allowance = previous_allowance * (1 + uplift_rate)
        sim.set_input(&quot;uc_standard_allowance&quot;, year, new_allowance)

# Create the UC rebalancing scenario
uc_rebalancing = Scenario(simulation_modifier=modify_uc_for_new_claimants)

# This scenario needs the rebalancing parameters to be active
uc_rebalancing_active = Scenario(parameter_changes={
    &quot;gov.dwp.universal_credit.rebalancing.active&quot;: True
}) + uc_rebalancing

# Test on a typical UC claimant
uc_claimant = {
    &quot;people&quot;: {
        &quot;person&quot;: {
            &quot;age&quot;: {2026: 35},
            &quot;employment_income&quot;: {2026: 8_000},
            &quot;uc_LCWRA_element&quot;: {2026: 390}  # Monthly health element
        }
    },
    &quot;benunits&quot;: {&quot;benunit&quot;: {&quot;members&quot;: [&quot;person&quot;]}},
    &quot;households&quot;: {
        &quot;home&quot;: {
            &quot;members&quot;: [&quot;person&quot;],
            &quot;housing_costs&quot;: {2026: 7200}
        }
    }
}

baseline_sim = Simulation(situation=uc_claimant)
reformed_sim = Simulation(situation=uc_claimant, scenario=uc_rebalancing_active)

# Compare UC components
for year in [2026, 2028]:
    baseline_uc = baseline_sim.calculate(&quot;universal_credit&quot;, year).mean()
    reformed_uc = reformed_sim.calculate(&quot;universal_credit&quot;, year).mean()
    print(f&quot;{year}: Baseline UC £{baseline_uc:.0f}/month, reformed £{reformed_uc:.0f}/month&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h2 id="analysing-scenarios-at-population-level" class="relative group"><span class="heading-text">Analysing scenarios at population level</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#analysing-scenarios-at-population-level" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Use microsimulation to understand the broader impact of your scenarios:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from policyengine_uk import Microsimulation

# Create a major scenario package combining tax cuts and benefit increases
# This represents a significant fiscal intervention
major_scenario = Scenario(parameter_changes={
    &quot;gov.hmrc.income_tax.rates.uk[0].rate&quot;: 0.15,          # Cut basic rate from 20% to 15%
    &quot;gov.hmrc.income_tax.personal_allowance&quot;: 16_000,       # Raise allowance significantly
    &quot;gov.dwp.universal_credit.standard_allowance.single.OVER_25&quot;: 600,  # Increase UC by £100/month
    &quot;gov.dwp.universal_credit.means_test.reduction_rate&quot;: 0.45  # Reduce taper from 55% to 45%
})

# Compare baseline and reform
baseline = Microsimulation(
    dataset=&quot;hf://policyengine/policyengine-uk-data/enhanced_frs_2022_23.h5&quot;
)
reformed = Microsimulation(
    dataset=&quot;hf://policyengine/policyengine-uk-data/enhanced_frs_2022_23.h5&quot;,
    scenario=major_scenario
)

# Calculate the fiscal impact of this major intervention
# Tax cuts reduce revenue, benefit increases raise spending
baseline_revenue = baseline.calculate(&quot;income_tax&quot;, 2025).sum() / 1e9
reformed_revenue = reformed.calculate(&quot;income_tax&quot;, 2025).sum() / 1e9
tax_cost = baseline_revenue - reformed_revenue

baseline_uc = baseline.calculate(&quot;universal_credit&quot;, 2025).sum() / 1e9
reformed_uc = reformed.calculate(&quot;universal_credit&quot;, 2025).sum() / 1e9
uc_cost = reformed_uc - baseline_uc

total_cost = tax_cost + uc_cost

print(f&quot;Income tax revenue loss: £{tax_cost:.1f}bn&quot;)
print(f&quot;UC spending increase: £{uc_cost:.1f}bn&quot;)
print(f&quot;Total fiscal cost: £{total_cost:.1f}bn&quot;)

# Calculate distributional impact
baseline_poverty = baseline.calculate(&quot;in_poverty&quot;, 2025).mean()
reformed_poverty = reformed.calculate(&quot;in_poverty&quot;, 2025).mean()
poverty_reduction = baseline_poverty - reformed_poverty

print(f&quot;Poverty rate reduction: {poverty_reduction:.1%}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h2 id="testing-scenarios-step-by-step" class="relative group"><span class="heading-text">Testing scenarios step by step</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#testing-scenarios-step-by-step" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>When building complex scenarios, test each component separately:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Build up a complex scenario incrementally to understand each component&#x27;s impact
# Starting with an empty scenario as our baseline
base_scenario = Scenario(parameter_changes={})

# Add income tax changes
with_tax_changes = base_scenario + Scenario(parameter_changes={
    &quot;gov.hmrc.income_tax.rates.uk[0].rate&quot;: 0.18,
    &quot;gov.hmrc.income_tax.personal_allowance&quot;: 14_000
})

# Add UC changes
with_uc_changes = with_tax_changes + Scenario(parameter_changes={
    &quot;gov.dwp.universal_credit.standard_allowance.single.OVER_25&quot;: 500,
    &quot;gov.dwp.universal_credit.means_test.reduction_rate&quot;: 0.50
})

# Add child benefit changes
full_scenario = with_uc_changes + Scenario(parameter_changes={
    &quot;gov.hmrc.child_benefit.rates.first_child&quot;: 25,
    &quot;gov.hmrc.child_benefit.rates.additional_child&quot;: 18
})

# Test the impact of each addition
test_situation = {
    &quot;people&quot;: {
        &quot;parent&quot;: {&quot;age&quot;: {2025: 30}, &quot;employment_income&quot;: {2025: 25_000}},
        &quot;child&quot;: {&quot;age&quot;: {2025: 6}}
    },
    &quot;benunits&quot;: {&quot;family&quot;: {&quot;members&quot;: [&quot;parent&quot;, &quot;child&quot;]}},
    &quot;households&quot;: {&quot;home&quot;: {&quot;members&quot;: [&quot;parent&quot;, &quot;child&quot;], &quot;housing_costs&quot;: {2025: 8400}}}  # Annual housing costs
}

# Test each incremental addition to see cumulative effects
scenarios = [(&quot;Baseline&quot;, base_scenario), (&quot;With tax changes&quot;, with_tax_changes),
             (&quot;With UC changes&quot;, with_uc_changes), (&quot;Full package&quot;, full_scenario)]

for name, scenario in scenarios:
    sim = Simulation(situation=test_situation, scenario=scenario)
    net_income = sim.calculate(&quot;household_net_income&quot;, 2025).mean()
    print(f&quot;{name}: £{net_income/12:.2f} per month&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h2 id="practical-tips-for-scenario-design" class="relative group"><span class="heading-text">Practical tips for scenario design</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#practical-tips-for-scenario-design" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ul><li>Start simple and build complexity gradually</li><li>Test scenarios on multiple household types to understand different impacts</li><li>Use meaningful parameter names and document your choices</li><li>Combine related changes logically (tax reforms with tax reforms, benefit changes with benefit changes)</li><li>Always check the fiscal impact of major reforms</li><li>Consider unintended interactions between different policy areas</li></ul><p>These techniques let you model complex policy changes that go beyond simple parameter adjustments. Simulation modifiers give you complete control over how the tax-benefit system works, allowing you to implement everything from gradual phase-outs to dynamic eligibility changes. The key is to understand the underlying data structures and use them thoughtfully to represent real policy proposals.</p><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/simulations"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Usage</div>Running simulations</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/growthfactors"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Assumptions</div>Economic assumptions</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/build/_shared/chunk-JSE36H2O.js"/><link rel="modulepreload" href="/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/build/root-IB5726YR.js"/><link rel="modulepreload" href="/build/_shared/chunk-NBON2RSI.js"/><link rel="modulepreload" href="/build/routes/$-LXLHKVOR.js"/><script>window.__remixContext = {"url":"/scenarios","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.0","options":{"logo":"/build/logo-2bd7d2ab9c2d9ac8ba7bbafb653bd229.png"},"nav":[],"actions":[],"projects":[{"title":"PolicyEngine UK documentation","authors":[{"nameParsed":{"literal":"PolicyEngine","family":"PolicyEngine"},"name":"PolicyEngine","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/policyengine/policyengine-uk","copyright":"2024","toc":[{"file":"index"},{"children":[{"file":"usage/getting-started"},{"file":"usage/simulations"},{"file":"usage/scenarios"}],"title":"Usage"},{"children":[{"file":"assumptions/growthfactors"},{"file":"assumptions/water-bills"}],"title":"Assumptions"},{"children":[{"file":"validation/hbai"}],"title":"Validation"},{"children":[{"file":"policy/model-baseline"},{"file":"policy/uc-rebalancing"}],"title":"Policy"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Usage"},{"slug":"getting-started","title":"Getting started","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"simulations","title":"Running simulations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"scenarios","title":"Creating policy scenarios","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Assumptions"},{"slug":"growthfactors","title":"Economic assumptions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"water-bills","title":"Water bills projection and uprating","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Validation"},{"slug":"hbai","title":"HBAI","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Policy"},{"slug":"model-baseline","title":"Model baseline","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"uc-rebalancing","title":"Universal Credit rebalancing reforms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static"},"routes/$":{"config":{"version":2,"myst":"1.6.0","options":{"logo":"/build/logo-2bd7d2ab9c2d9ac8ba7bbafb653bd229.png"},"nav":[],"actions":[],"projects":[{"title":"PolicyEngine UK documentation","authors":[{"nameParsed":{"literal":"PolicyEngine","family":"PolicyEngine"},"name":"PolicyEngine","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/policyengine/policyengine-uk","copyright":"2024","toc":[{"file":"index"},{"children":[{"file":"usage/getting-started"},{"file":"usage/simulations"},{"file":"usage/scenarios"}],"title":"Usage"},{"children":[{"file":"assumptions/growthfactors"},{"file":"assumptions/water-bills"}],"title":"Assumptions"},{"children":[{"file":"validation/hbai"}],"title":"Validation"},{"children":[{"file":"policy/model-baseline"},{"file":"policy/uc-rebalancing"}],"title":"Policy"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Usage"},{"slug":"getting-started","title":"Getting started","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"simulations","title":"Running simulations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"scenarios","title":"Creating policy scenarios","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Assumptions"},{"slug":"growthfactors","title":"Economic assumptions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"water-bills","title":"Water bills projection and uprating","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Validation"},{"slug":"hbai","title":"HBAI","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Policy"},{"slug":"model-baseline","title":"Model baseline","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"uc-rebalancing","title":"Universal Credit rebalancing reforms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Article","sha256":"ed3f765bb52dd5015e4cb7009a956c97c7ed662e6dcca9e502f5db58b0cbac71","slug":"scenarios","location":"/usage/scenarios.md","dependencies":[],"frontmatter":{"title":"Creating policy scenarios","content_includes_title":false,"authors":[{"nameParsed":{"literal":"PolicyEngine","family":"PolicyEngine"},"name":"PolicyEngine","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/policyengine/policyengine-uk","copyright":"2024","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/policyengine/policyengine-uk/blob/master/docs/book/usage/scenarios.md","exports":[{"format":"md","filename":"scenarios.md","url":"/build/scenarios-1cd6da8cd4c8288be0260022c1fb89cb.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ievjoaVsPc"},{"type":"inlineCode","value":"Scenario","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FXrHz3o9pR"},{"type":"text","value":" class lets you define policy reforms and apply them to simulations. This guide shows you how to create everything from simple parameter changes to complex reform packages, and how to combine different policy ideas together.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Wy9KxzQGrs"}],"key":"ukTHI4nmFj"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Your first policy scenario","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fdsASDxA9h"}],"identifier":"your-first-policy-scenario","label":"Your first policy scenario","html_id":"your-first-policy-scenario","implicit":true,"key":"B6PVC2zI3B"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Let’s start by creating a scenario that reduces the basic rate of income tax from 20% to 15%:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FqFPWuky9h"}],"key":"a1vEzkrayc"},{"type":"code","lang":"python","value":"from policyengine_uk import Scenario, Simulation\n\n# Create a scenario with one policy change\nscenario = Scenario(parameter_changes={\n    \"gov.hmrc.income_tax.rates.uk[0].rate\": 0.15\n})\n\n# Apply it to a simulation\nsituation = {\n    \"people\": {\n        \"person\": {\n            \"age\": {2025: 35},\n            \"employment_income\": {2025: 40_000}\n        }\n    },\n    \"benunits\": {\"benunit\": {\"members\": [\"person\"]}},\n    \"households\": {\"household\": {\"members\": [\"person\"]}}\n}\n\nsim = Simulation(situation=situation, scenario=scenario)\nincome_tax = sim.calculate(\"income_tax\", 2025).mean()\nprint(f\"Income tax under 15% basic rate: £{income_tax:.2f}\")","position":{"start":{"line":9,"column":1},"end":{"line":32,"column":1}},"key":"szcxYx6WNf"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Under this scenario, this person would pay £2,486 instead of the current £4,486 - a reduction of £2,000 per year due to the lower tax rate.","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"sXdTXu5lHO"}],"key":"XNAxw6j06g"},{"type":"heading","depth":2,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Understanding parameter paths","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"d24VvRWGzn"}],"identifier":"understanding-parameter-paths","label":"Understanding parameter paths","html_id":"understanding-parameter-paths","implicit":true,"key":"XJ8WTq5soV"},{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"PolicyEngine UK organises policy parameters in a hierarchical structure. Each parameter has a path that describes where it sits in the system:","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"HIGooVQaXS"}],"key":"IP815Ct1NZ"},{"type":"code","lang":"python","value":"# Income tax parameters\n\"gov.hmrc.income_tax.rates.uk[0].rate\"          # Basic rate (20%)\n\"gov.hmrc.income_tax.rates.uk[1].rate\"          # Higher rate (40%)\n\"gov.hmrc.income_tax.personal_allowance\"        # Personal allowance\n\"gov.hmrc.income_tax.rates.uk[0].threshold\"     # Basic rate threshold\n\n# Universal Credit parameters\n\"gov.dwp.universal_credit.standard_allowance.single.OVER_25\"     # Single person allowance\n\"gov.dwp.universal_credit.elements.housing.max_monthly_cap\"      # Housing cost cap\n\"gov.dwp.universal_credit.means_test.income_disregard\"           # Work allowance\n\n# Child benefits\n\"gov.hmrc.child_benefit.rates.first_child\"      # First child rate\n\"gov.hmrc.child_benefit.rates.additional_child\" # Additional children rate","position":{"start":{"line":40,"column":1},"end":{"line":55,"column":1}},"key":"jVyT2Ih2b3"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"You can find parameter paths by exploring the PolicyEngine web app or looking in the ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"P0dKF7SRxO"},{"type":"inlineCode","value":"parameters/","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"DpQxyvvNax"},{"type":"text","value":" directory of the codebase.","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"LGqfdcMe7u"}],"key":"tAWfDkqD02"},{"type":"heading","depth":2,"position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"Creating comprehensive reform packages","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"N00jAcRMxz"}],"identifier":"creating-comprehensive-reform-packages","label":"Creating comprehensive reform packages","html_id":"creating-comprehensive-reform-packages","implicit":true,"key":"I0lPrIINHr"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Real policy proposals often involve multiple changes. Here’s how to create a comprehensive reform:","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"UYlFbSumVO"}],"key":"K1ZsZPoVy8"},{"type":"code","lang":"python","value":"# A comprehensive package that increases Universal Credit support while adjusting income tax\n# This represents the kind of coordinated policy change you might see in a budget\nwelfare_reform = Scenario(parameter_changes={\n    # Increase UC standard allowances\n    \"gov.dwp.universal_credit.standard_allowance.single.OVER_25\": 500,\n    \"gov.dwp.universal_credit.standard_allowance.single.UNDER_25\": 400,\n    \"gov.dwp.universal_credit.standard_allowance.couple\": 700,\n    \n    # Reduce UC taper rate (less benefit withdrawn per pound earned)\n    \"gov.dwp.universal_credit.means_test.reduction_rate\": 0.55,\n    \n    # Increase income tax personal allowance\n    \"gov.hmrc.income_tax.personal_allowance\": 15_000,\n    \n    # Reduce basic rate slightly to help fund UC increases\n    \"gov.hmrc.income_tax.rates.uk[0].rate\": 0.22\n})\n\n# Test on a working family\nfamily_situation = {\n    \"people\": {\n        \"parent\": {\"age\": {2025: 30}, \"employment_income\": {2025: 20_000}},\n        \"child\": {\"age\": {2025: 5}}\n    },\n    \"benunits\": {\"family\": {\"members\": [\"parent\", \"child\"]}},\n    \"households\": {\n        \"home\": {\n            \"members\": [\"parent\", \"child\"],\n            \"housing_costs\": {2025: 7200}  # Annual housing costs\n        }\n    }\n}\n\nreformed_sim = Simulation(situation=family_situation, scenario=welfare_reform)\n\n# Calculate the impact of this comprehensive package on the family\nuc_amount = reformed_sim.calculate(\"universal_credit\", 2025).mean()\nincome_tax = reformed_sim.calculate(\"income_tax\", 2025).mean()\nnet_income = reformed_sim.calculate(\"household_net_income\", 2025).mean()\n\nprint(f\"Universal Credit: £{uc_amount:.2f} per month\")\nprint(f\"Income tax: £{income_tax:.2f} per year\")\nprint(f\"Monthly net income: £{net_income/12:.2f}\")","position":{"start":{"line":63,"column":1},"end":{"line":107,"column":1}},"key":"xpbd8FDDNo"},{"type":"heading","depth":2,"position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"Combining scenarios","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"k3ynr9YjAY"}],"identifier":"combining-scenarios","label":"Combining scenarios","html_id":"combining-scenarios","implicit":true,"key":"LCksQWG6fU"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"You can combine different scenarios using the ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"HIlNM7KfHJ"},{"type":"inlineCode","value":"+","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"jkZK1KFyvT"},{"type":"text","value":" operator, which is useful for testing different combinations of policies:","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"r49JhcY0ap"}],"key":"vMIndvccn0"},{"type":"code","lang":"python","value":"# Create separate scenarios for different policy areas\ntax_scenario = Scenario(parameter_changes={\n    \"gov.hmrc.income_tax.personal_allowance\": 15_000,\n    \"gov.hmrc.income_tax.rates.uk[0].rate\": 0.18\n})\n\nbenefits_scenario = Scenario(parameter_changes={\n    \"gov.dwp.universal_credit.standard_allowance.single.OVER_25\": 450,\n    \"gov.dwp.universal_credit.means_test.reduction_rate\": 0.50\n})\n\nchildcare_scenario = Scenario(parameter_changes={\n    \"gov.dwp.universal_credit.elements.childcare.max_proportion\": 0.90\n})\n\n# Combine them in different ways\ntax_and_benefits = tax_scenario + benefits_scenario\nfull_package = tax_scenario + benefits_scenario + childcare_scenario\n\n# Test each combination to see how different policy areas interact\n# This shows how you can build up complex policies piece by piece\nfor name, scenario in [(\"Tax only\", tax_scenario), (\"Benefits only\", benefits_scenario), \n                      (\"Tax + benefits\", tax_and_benefits), (\"Full package\", full_package)]:\n    sim = Simulation(situation=family_situation, scenario=scenario)\n    net_income = sim.calculate(\"household_net_income\", 2025).mean()\n    print(f\"{name}: £{net_income/12:.2f} per month\")","position":{"start":{"line":113,"column":1},"end":{"line":140,"column":1}},"key":"FapsFxC4PR"},{"type":"heading","depth":2,"position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"children":[{"type":"text","value":"Defining structural scenarios","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"mB11Xe1kqS"}],"identifier":"defining-structural-scenarios","label":"Defining structural scenarios","html_id":"defining-structural-scenarios","implicit":true,"key":"DTRjJT8AYX"},{"type":"paragraph","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"text","value":"Beyond simple parameter changes, you sometimes need scenarios that make structural modifications to how the tax-benefit system works. Let’s walk through how to create these, using examples similar to those in PolicyEngine UK’s scenarios module.","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"zFjBXUWSRf"}],"key":"dc2Xc6Hqnh"},{"type":"heading","depth":3,"position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"Creating a two-child limit repeal scenario","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"gwrzKjgj5Z"}],"identifier":"creating-a-two-child-limit-repeal-scenario","label":"Creating a two-child limit repeal scenario","html_id":"creating-a-two-child-limit-repeal-scenario","implicit":true,"key":"rdHXKsMrNp"},{"type":"paragraph","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"text","value":"The two-child limit restricts Universal Credit child elements to the first two children. Here’s how to build a scenario that removes this restriction:","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"wFe3fHEOSl"}],"key":"H49Tm1gDIT"},{"type":"code","lang":"python","value":"import numpy as np\nfrom policyengine_uk import Scenario\n\n# The two-child limit is controlled by this parameter\n# Setting it to infinity effectively removes the limit\nrepeal_two_child_limit = Scenario(parameter_changes={\n    \"gov.dwp.universal_credit.elements.child.limit.child_count\": {\n        \"year:2026:10\": np.inf  # From October 2026 onwards, no limit\n    }\n})\n\n# Test this on a family with three children\nlarge_family = {\n    \"people\": {\n        \"parent\": {\"age\": {2026: 35}, \"employment_income\": {2026: 18_000}},\n        \"child1\": {\"age\": {2026: 12}},\n        \"child2\": {\"age\": {2026: 8}},\n        \"child3\": {\"age\": {2026: 4}}  # Third child - currently gets no UC support\n    },\n    \"benunits\": {\"family\": {\"members\": [\"parent\", \"child1\", \"child2\", \"child3\"]}},\n    \"households\": {\n        \"home\": {\n            \"members\": [\"parent\", \"child1\", \"child2\", \"child3\"],\n            \"housing_costs\": {2026: 10200}  # Annual housing costs\n        }\n    }\n}\n\n# Compare the impact\nbaseline_sim = Simulation(situation=large_family)\nreformed_sim = Simulation(situation=large_family, scenario=repeal_two_child_limit)\n\nbaseline_uc = baseline_sim.calculate(\"universal_credit\", 2026).mean()\nreformed_uc = reformed_sim.calculate(\"universal_credit\", 2026).mean()\n\nincrease = reformed_uc - baseline_uc\nprint(f\"UC increase from third child: £{increase:.2f} per month\")","position":{"start":{"line":150,"column":1},"end":{"line":188,"column":1}},"key":"sLLL8crD8z"},{"type":"heading","depth":3,"position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"Building a benefit cap reindexing scenario","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"KdAIH8YqN0"}],"identifier":"building-a-benefit-cap-reindexing-scenario","label":"Building a benefit cap reindexing scenario","html_id":"building-a-benefit-cap-reindexing-scenario","implicit":true,"key":"lueCQK1gJZ"},{"type":"paragraph","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"The benefit cap hasn’t risen with inflation since 2016. Here’s how to create a scenario that automatically indexes it to CPI:","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"YLvVBoyxEJ"}],"key":"iNym41XCx7"},{"type":"code","lang":"python","value":"from policyengine_uk import Scenario, Simulation\nfrom policyengine_core.parameters import Parameter\n\ndef reindex_benefit_cap_to_cpi(simulation: Simulation):\n    \"\"\"Modify simulation to index benefit cap parameters to CPI inflation\"\"\"\n    # Reset the parameter system to make changes\n    simulation.tax_benefit_system.reset_parameters()\n    \n    # Find all benefit cap parameters in the system\n    params = simulation.tax_benefit_system.parameters.gov.dwp.benefit_cap.get_descendants()\n    \n    # Filter to only the actual parameter values (leaf nodes)\n    cap_parameters = [param for param in params if isinstance(param, Parameter)]\n    \n    for parameter in cap_parameters:\n        # Remove any values after 2025 (current frozen values)\n        parameter.values_list = [\n            entry for entry in parameter.values_list \n            if entry.instant_str \u003c \"2026-01-01\"\n        ]\n        \n        # Set the parameter to follow CPI uprating from 2026\n        parameter.metadata.update(uprating=\"gov.benefit_uprating_cpi\")\n    \n    # Reprocess the parameters to apply changes\n    simulation.tax_benefit_system.process_parameters()\n\n# Create the scenario using a simulation modifier\nreindex_benefit_cap = Scenario(simulation_modifier=reindex_benefit_cap_to_cpi)\n\n# Test on a family that might hit the benefit cap\nbenefit_cap_family = {\n    \"people\": {\n        \"parent1\": {\"age\": {2026: 30}, \"employment_income\": {2026: 0}},\n        \"parent2\": {\"age\": {2026: 28}, \"employment_income\": {2026: 0}},\n        \"child1\": {\"age\": {2026: 6}},\n        \"child2\": {\"age\": {2026: 3}}\n    },\n    \"benunits\": {\"family\": {\"members\": [\"parent1\", \"parent2\", \"child1\", \"child2\"]}},\n    \"households\": {\n        \"home\": {\n            \"members\": [\"parent1\", \"parent2\", \"child1\", \"child2\"],\n            \"housing_costs\": {2026: 14400}  # High annual housing costs\n        }\n    }\n}\n\nbaseline_sim = Simulation(situation=benefit_cap_family)\nreformed_sim = Simulation(situation=benefit_cap_family, scenario=reindex_benefit_cap)\n\n# Compare the benefit cap levels\nbaseline_cap = baseline_sim.calculate(\"benefit_cap\", 2026).mean()\nreformed_cap = reformed_sim.calculate(\"benefit_cap\", 2026).mean()\n\nprint(f\"Benefit cap - frozen: £{baseline_cap:.0f}/year, indexed: £{reformed_cap:.0f}/year\")","position":{"start":{"line":194,"column":1},"end":{"line":250,"column":1}},"key":"nxQGBg1IVf"},{"type":"heading","depth":2,"position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"Advanced scenario techniques","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"AuSNex2Tnm"}],"identifier":"advanced-scenario-techniques","label":"Advanced scenario techniques","html_id":"advanced-scenario-techniques","implicit":true,"key":"kjTlFcd0QQ"},{"type":"heading","depth":3,"position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"children":[{"type":"text","value":"Time-varying parameters","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"j1Gwvepnsc"}],"identifier":"time-varying-parameters","label":"Time-varying parameters","html_id":"time-varying-parameters","implicit":true,"key":"IIOqFFrqLO"},{"type":"paragraph","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"text","value":"Some reforms phase in over time:","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"nVzoWKW9cp"}],"key":"kSvyVd0TJ1"},{"type":"code","lang":"python","value":"# A scenario that gradually increases the personal allowance over four years\n# This kind of phasing helps manage fiscal costs and economic adjustment\nphased_scenario = Scenario(parameter_changes={\n    \"gov.hmrc.income_tax.personal_allowance\": {\n        \"2025\": 13_000,\n        \"2026\": 14_000,\n        \"2027\": 15_000,\n        \"2028\": 16_000\n    }\n})\n\n# Test this on a middle-income earner to see the progressive impact\nsituation = {\n    \"people\": {\"person\": {\"age\": {2025: 30}, \"employment_income\": {2025: 35_000}}},\n    \"benunits\": {\"benunit\": {\"members\": [\"person\"]}},\n    \"households\": {\"household\": {\"members\": [\"person\"]}}\n}\n\nsim = Simulation(situation=situation, scenario=phased_scenario)\n\n# Show how the tax burden decreases year by year\nfor year in [2025, 2026, 2027, 2028]:\n    allowance = sim.calculate(\"income_tax_personal_allowance\", year).mean()\n    tax = sim.calculate(\"income_tax\", year).mean()\n    print(f\"{year}: Personal allowance £{allowance:.0f}, annual tax £{tax:.2f}\")","position":{"start":{"line":258,"column":1},"end":{"line":284,"column":1}},"key":"rQxFX9wEbF"},{"type":"heading","depth":3,"position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"Creating complex scenarios with simulation modifiers","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"fdKTGPmnah"}],"identifier":"creating-complex-scenarios-with-simulation-modifiers","label":"Creating complex scenarios with simulation modifiers","html_id":"creating-complex-scenarios-with-simulation-modifiers","implicit":true,"key":"M8YiP1JFmJ"},{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"Some policy changes require modifying individual records rather than just changing parameters. Here’s how to build a scenario that phases out PIP payments for some claimants over time:","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"dczs9hCjQi"}],"key":"rD9NaRBS5g"},{"type":"code","lang":"python","value":"import numpy as np\nfrom policyengine_uk import Scenario, Simulation\n\ndef phase_out_pip_gradually(sim: Simulation):\n    \"\"\"Gradually phase out PIP for a proportion of claimants between 2025-2029\"\"\"\n    # Set random seed for reproducible results\n    np.random.seed(42)\n    \n    # Create random assignment for each person\n    pip_phase_out_seed = np.random.random(len(sim.calculate(\"person_id\")))\n    \n    # Define the phase-out period\n    start_year = 2025\n    end_year = 2029\n    \n    # Apply phase-out year by year\n    for year in range(start_year, end_year + 1):\n        # Get current PIP payments\n        current_pip = sim.calculate(\"pip\", year)\n        \n        # Calculate how far through the phase-out we are\n        phase_progress = (year - start_year) / (end_year - start_year)\n        \n        # 25% of claimants lose PIP, gradually over the period\n        # In year 1, nobody loses it; by final year, 25% have lost it completely\n        affected_threshold = 0.25 * phase_progress\n        \n        # Set PIP to zero for affected claimants\n        current_pip[pip_phase_out_seed \u003c affected_threshold] = 0\n        \n        # Apply the modified values back to the simulation\n        sim.set_input(\"pip\", year, current_pip)\n    \n    return sim\n\n# Create the scenario\npip_phase_out = Scenario(simulation_modifier=phase_out_pip_gradually)\n\n# Test on someone who receives PIP\npip_recipient = {\n    \"people\": {\n        \"person\": {\n            \"age\": {2025: 45},\n            \"pip\": {2025: 150},  # Weekly PIP payment\n            \"employment_income\": {2025: 8_000}\n        }\n    },\n    \"benunits\": {\"benunit\": {\"members\": [\"person\"]}},\n    \"households\": {\"household\": {\"members\": [\"person\"]}}\n}\n\n# Compare baseline and phase-out scenarios\nbaseline_sim = Simulation(situation=pip_recipient)\nreformed_sim = Simulation(situation=pip_recipient, scenario=pip_phase_out)\n\n# Show how PIP changes over the phase-out period\nfor year in [2025, 2027, 2029]:\n    baseline_pip = baseline_sim.calculate(\"pip\", year).mean()\n    reformed_pip = reformed_sim.calculate(\"pip\", year).mean()\n    print(f\"{year}: Baseline £{baseline_pip:.0f}/week, with phase-out £{reformed_pip:.0f}/week\")","position":{"start":{"line":290,"column":1},"end":{"line":351,"column":1}},"key":"cUzq2UVSLp"},{"type":"heading","depth":3,"position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"children":[{"type":"text","value":"Building Universal Credit scenarios with dynamic changes","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"GhrIRPI9vr"}],"identifier":"building-universal-credit-scenarios-with-dynamic-changes","label":"Building Universal Credit scenarios with dynamic changes","html_id":"building-universal-credit-scenarios-with-dynamic-changes","implicit":true,"key":"PQTUEj77aA"},{"type":"paragraph","position":{"start":{"line":355,"column":1},"end":{"line":355,"column":1}},"children":[{"type":"text","value":"Some scenarios need to make changes that depend on the simulation’s own data. Here’s how to create a UC scenario that adjusts payments based on claimant characteristics:","position":{"start":{"line":355,"column":1},"end":{"line":355,"column":1}},"key":"EcIYojzdQr"}],"key":"gTqu8LJiiS"},{"type":"code","lang":"python","value":"from policyengine_uk import Scenario, Microsimulation\nimport numpy as np\n\ndef modify_uc_for_new_claimants(sim: Microsimulation):\n    \"\"\"Reduce health elements for new UC claimants while increasing standard allowances\"\"\"\n    # Access the parameter system to check if reforms are active\n    rebalancing_params = sim.tax_benefit_system.parameters.gov.dwp.universal_credit.rebalancing\n    \n    # Create random assignment to simulate new vs existing claimants\n    np.random.seed(42)\n    uc_seed = np.random.random(len(sim.calculate(\"benunit_id\")))\n    \n    # Proportion of claimants who are \"new\" each year (based on real data)\n    new_claimant_rates = {\n        2025: 0.00,  # No change in 2025\n        2026: 0.11,  # 11% are new claimants\n        2027: 0.13,\n        2028: 0.16,\n        2029: 0.22\n    }\n    \n    # Apply changes year by year\n    for year in range(2026, 2030):\n        if not rebalancing_params.active(year):\n            continue  # Skip if reforms aren't active this year\n            \n        # Identify new claimants\n        is_new_claimant = uc_seed \u003c new_claimant_rates[year]\n        \n        # Modify health element for new claimants\n        current_health_element = sim.calculate(\"uc_LCWRA_element\", year)\n        new_health_amount = rebalancing_params.new_claimant_health_element(year) * 12\n        \n        # Set new amount for new claimants who get health element\n        current_health_element[\n            (current_health_element \u003e 0) \u0026 is_new_claimant\n        ] = new_health_amount\n        \n        sim.set_input(\"uc_LCWRA_element\", year, current_health_element)\n        \n        # Increase standard allowances for everyone\n        uplift_rate = rebalancing_params.standard_allowance_uplift(year)\n        previous_allowance = sim.calculate(\"uc_standard_allowance\", year - 1)\n        new_allowance = previous_allowance * (1 + uplift_rate)\n        sim.set_input(\"uc_standard_allowance\", year, new_allowance)\n\n# Create the UC rebalancing scenario\nuc_rebalancing = Scenario(simulation_modifier=modify_uc_for_new_claimants)\n\n# This scenario needs the rebalancing parameters to be active\nuc_rebalancing_active = Scenario(parameter_changes={\n    \"gov.dwp.universal_credit.rebalancing.active\": True\n}) + uc_rebalancing\n\n# Test on a typical UC claimant\nuc_claimant = {\n    \"people\": {\n        \"person\": {\n            \"age\": {2026: 35},\n            \"employment_income\": {2026: 8_000},\n            \"uc_LCWRA_element\": {2026: 390}  # Monthly health element\n        }\n    },\n    \"benunits\": {\"benunit\": {\"members\": [\"person\"]}},\n    \"households\": {\n        \"home\": {\n            \"members\": [\"person\"],\n            \"housing_costs\": {2026: 7200}\n        }\n    }\n}\n\nbaseline_sim = Simulation(situation=uc_claimant)\nreformed_sim = Simulation(situation=uc_claimant, scenario=uc_rebalancing_active)\n\n# Compare UC components\nfor year in [2026, 2028]:\n    baseline_uc = baseline_sim.calculate(\"universal_credit\", year).mean()\n    reformed_uc = reformed_sim.calculate(\"universal_credit\", year).mean()\n    print(f\"{year}: Baseline UC £{baseline_uc:.0f}/month, reformed £{reformed_uc:.0f}/month\")","position":{"start":{"line":357,"column":1},"end":{"line":438,"column":1}},"key":"vV0X4ywcSx"},{"type":"heading","depth":2,"position":{"start":{"line":440,"column":1},"end":{"line":440,"column":1}},"children":[{"type":"text","value":"Analysing scenarios at population level","position":{"start":{"line":440,"column":1},"end":{"line":440,"column":1}},"key":"DmnpQ7xQ9s"}],"identifier":"analysing-scenarios-at-population-level","label":"Analysing scenarios at population level","html_id":"analysing-scenarios-at-population-level","implicit":true,"key":"NcvnWwlwKR"},{"type":"paragraph","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"children":[{"type":"text","value":"Use microsimulation to understand the broader impact of your scenarios:","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"vbor7TotWc"}],"key":"tejVMWgXu3"},{"type":"code","lang":"python","value":"from policyengine_uk import Microsimulation\n\n# Create a major scenario package combining tax cuts and benefit increases\n# This represents a significant fiscal intervention\nmajor_scenario = Scenario(parameter_changes={\n    \"gov.hmrc.income_tax.rates.uk[0].rate\": 0.15,          # Cut basic rate from 20% to 15%\n    \"gov.hmrc.income_tax.personal_allowance\": 16_000,       # Raise allowance significantly\n    \"gov.dwp.universal_credit.standard_allowance.single.OVER_25\": 600,  # Increase UC by £100/month\n    \"gov.dwp.universal_credit.means_test.reduction_rate\": 0.45  # Reduce taper from 55% to 45%\n})\n\n# Compare baseline and reform\nbaseline = Microsimulation(\n    dataset=\"hf://policyengine/policyengine-uk-data/enhanced_frs_2022_23.h5\"\n)\nreformed = Microsimulation(\n    dataset=\"hf://policyengine/policyengine-uk-data/enhanced_frs_2022_23.h5\",\n    scenario=major_scenario\n)\n\n# Calculate the fiscal impact of this major intervention\n# Tax cuts reduce revenue, benefit increases raise spending\nbaseline_revenue = baseline.calculate(\"income_tax\", 2025).sum() / 1e9\nreformed_revenue = reformed.calculate(\"income_tax\", 2025).sum() / 1e9\ntax_cost = baseline_revenue - reformed_revenue\n\nbaseline_uc = baseline.calculate(\"universal_credit\", 2025).sum() / 1e9\nreformed_uc = reformed.calculate(\"universal_credit\", 2025).sum() / 1e9\nuc_cost = reformed_uc - baseline_uc\n\ntotal_cost = tax_cost + uc_cost\n\nprint(f\"Income tax revenue loss: £{tax_cost:.1f}bn\")\nprint(f\"UC spending increase: £{uc_cost:.1f}bn\")\nprint(f\"Total fiscal cost: £{total_cost:.1f}bn\")\n\n# Calculate distributional impact\nbaseline_poverty = baseline.calculate(\"in_poverty\", 2025).mean()\nreformed_poverty = reformed.calculate(\"in_poverty\", 2025).mean()\npoverty_reduction = baseline_poverty - reformed_poverty\n\nprint(f\"Poverty rate reduction: {poverty_reduction:.1%}\")","position":{"start":{"line":444,"column":1},"end":{"line":487,"column":1}},"key":"w1CAdvhSEf"},{"type":"heading","depth":2,"position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"children":[{"type":"text","value":"Testing scenarios step by step","position":{"start":{"line":489,"column":1},"end":{"line":489,"column":1}},"key":"plCtuF72QW"}],"identifier":"testing-scenarios-step-by-step","label":"Testing scenarios step by step","html_id":"testing-scenarios-step-by-step","implicit":true,"key":"ir1rvhgrtx"},{"type":"paragraph","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"children":[{"type":"text","value":"When building complex scenarios, test each component separately:","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"key":"wT1yTUPJ7N"}],"key":"qYfp7bzDfi"},{"type":"code","lang":"python","value":"# Build up a complex scenario incrementally to understand each component's impact\n# Starting with an empty scenario as our baseline\nbase_scenario = Scenario(parameter_changes={})\n\n# Add income tax changes\nwith_tax_changes = base_scenario + Scenario(parameter_changes={\n    \"gov.hmrc.income_tax.rates.uk[0].rate\": 0.18,\n    \"gov.hmrc.income_tax.personal_allowance\": 14_000\n})\n\n# Add UC changes\nwith_uc_changes = with_tax_changes + Scenario(parameter_changes={\n    \"gov.dwp.universal_credit.standard_allowance.single.OVER_25\": 500,\n    \"gov.dwp.universal_credit.means_test.reduction_rate\": 0.50\n})\n\n# Add child benefit changes\nfull_scenario = with_uc_changes + Scenario(parameter_changes={\n    \"gov.hmrc.child_benefit.rates.first_child\": 25,\n    \"gov.hmrc.child_benefit.rates.additional_child\": 18\n})\n\n# Test the impact of each addition\ntest_situation = {\n    \"people\": {\n        \"parent\": {\"age\": {2025: 30}, \"employment_income\": {2025: 25_000}},\n        \"child\": {\"age\": {2025: 6}}\n    },\n    \"benunits\": {\"family\": {\"members\": [\"parent\", \"child\"]}},\n    \"households\": {\"home\": {\"members\": [\"parent\", \"child\"], \"housing_costs\": {2025: 8400}}}  # Annual housing costs\n}\n\n# Test each incremental addition to see cumulative effects\nscenarios = [(\"Baseline\", base_scenario), (\"With tax changes\", with_tax_changes),\n             (\"With UC changes\", with_uc_changes), (\"Full package\", full_scenario)]\n\nfor name, scenario in scenarios:\n    sim = Simulation(situation=test_situation, scenario=scenario)\n    net_income = sim.calculate(\"household_net_income\", 2025).mean()\n    print(f\"{name}: £{net_income/12:.2f} per month\")","position":{"start":{"line":493,"column":1},"end":{"line":534,"column":1}},"key":"uUy1NOjQMd"},{"type":"heading","depth":2,"position":{"start":{"line":536,"column":1},"end":{"line":536,"column":1}},"children":[{"type":"text","value":"Practical tips for scenario design","position":{"start":{"line":536,"column":1},"end":{"line":536,"column":1}},"key":"f0iEr3Z5qm"}],"identifier":"practical-tips-for-scenario-design","label":"Practical tips for scenario design","html_id":"practical-tips-for-scenario-design","implicit":true,"key":"XRNwYjLT9E"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":538,"column":1},"end":{"line":544,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"children":[{"type":"text","value":"Start simple and build complexity gradually","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"izspX8PwcC"}],"key":"EIML7r84Io"},{"type":"listItem","spread":true,"position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"children":[{"type":"text","value":"Test scenarios on multiple household types to understand different impacts","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"DjWnLU0v23"}],"key":"B0QZx7zDC5"},{"type":"listItem","spread":true,"position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"children":[{"type":"text","value":"Use meaningful parameter names and document your choices","position":{"start":{"line":540,"column":1},"end":{"line":540,"column":1}},"key":"guDofb86Zn"}],"key":"OUDDFbj6bz"},{"type":"listItem","spread":true,"position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"children":[{"type":"text","value":"Combine related changes logically (tax reforms with tax reforms, benefit changes with benefit changes)","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"key":"RhPqiV9yqd"}],"key":"WiFuf18gTy"},{"type":"listItem","spread":true,"position":{"start":{"line":542,"column":1},"end":{"line":542,"column":1}},"children":[{"type":"text","value":"Always check the fiscal impact of major reforms","position":{"start":{"line":542,"column":1},"end":{"line":542,"column":1}},"key":"b4i0IJs5ey"}],"key":"Afv2oiTRtW"},{"type":"listItem","spread":true,"position":{"start":{"line":543,"column":1},"end":{"line":544,"column":1}},"children":[{"type":"text","value":"Consider unintended interactions between different policy areas","position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"key":"brzo7ruJTH"}],"key":"sYWRtUBQM1"}],"key":"Z6UbKn9lHU"},{"type":"paragraph","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"children":[{"type":"text","value":"These techniques let you model complex policy changes that go beyond simple parameter adjustments. Simulation modifiers give you complete control over how the tax-benefit system works, allowing you to implement everything from gradual phase-outs to dynamic eligibility changes. The key is to understand the underlying data structures and use them thoughtfully to represent real policy proposals.","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"WJvOc1SQCM"}],"key":"TMhR70Ej9O"}],"key":"jrPIGmtZ4E"}],"key":"Xvczvn9TN8"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Running simulations","url":"/simulations","group":"Usage"},"next":{"title":"Economic assumptions","url":"/growthfactors","group":"Assumptions"}}},"domain":"http://localhost:3000"},"project":{"title":"PolicyEngine UK documentation","authors":[{"nameParsed":{"literal":"PolicyEngine","family":"PolicyEngine"},"name":"PolicyEngine","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/policyengine/policyengine-uk","copyright":"2024","toc":[{"file":"index"},{"children":[{"file":"usage/getting-started"},{"file":"usage/simulations"},{"file":"usage/scenarios"}],"title":"Usage"},{"children":[{"file":"assumptions/growthfactors"},{"file":"assumptions/water-bills"}],"title":"Assumptions"},{"children":[{"file":"validation/hbai"}],"title":"Validation"},{"children":[{"file":"policy/model-baseline"},{"file":"policy/uc-rebalancing"}],"title":"Policy"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Usage"},{"slug":"getting-started","title":"Getting started","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"simulations","title":"Running simulations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"scenarios","title":"Creating policy scenarios","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Assumptions"},{"slug":"growthfactors","title":"Economic assumptions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"water-bills","title":"Water bills projection and uprating","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Validation"},{"slug":"hbai","title":"HBAI","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Policy"},{"slug":"model-baseline","title":"Model baseline","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"uc-rebalancing","title":"Universal Credit rebalancing reforms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/build/manifest-B2B2E6A5.js";
import * as route0 from "/build/root-IB5726YR.js";
import * as route1 from "/build/routes/$-LXLHKVOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/build/entry.client-UNPC4GT3.js");</script></body></html>